(()=>{var t={n:s=>{var e=s&&s.__esModule?()=>s.default:()=>s;return t.d(e,{a:e}),e},d:(s,e)=>{for(var a in e)t.o(e,a)&&!t.o(s,a)&&Object.defineProperty(s,a,{enumerable:!0,get:e[a]})},o:(t,s)=>Object.prototype.hasOwnProperty.call(t,s)};(()=>{"use strict";const s=flarum.core.compat["forum/app"];var e=t.n(s);const a=flarum.core.compat["common/extend"],r=flarum.core.compat["forum/components/DiscussionListItem"];var o=t.n(r);flarum.core.compat["common/models/Discussion"];const n=flarum.core.compat["common/helpers/avatar"];var i=t.n(n);const u=flarum.core.compat["common/helpers/icon"];var c=t.n(u);const l=flarum.core.compat["common/utils/abbreviateNumber"];var p=t.n(l);e().initializers.add("custom/discussions-item",function(){console.log("custom/discussions-item"),(0,a.extend)(o().prototype,"contentItems",function(t){t.add("enhancedInfo",this.enhancedInfoView(),5),console.log("items",t),console.log("this.attrs.discussion",this.attrs)}),(0,a.extend)(o().prototype,"infoItems",function(t){console.log("items",t),t.add("authorAvatar",this.authorAvatarView(),1)}),o().prototype.authorAvatarView=function(){var t=this.attrs.discussion,s=!1!==e().forum.attribute("custom-discussions-item.enable_author_avatar"),a=parseInt(e().forum.attribute("custom-discussions-item.avatar_size"))||24;if(!s)return null;var r=t.user?t.user():null;return r?m("div",{className:"DiscussionListItem-author-avatar"},i()(r,{size:a})):null},o().prototype.enhancedInfoView=function(){this.attrs.discussion;var t=!1!==e().forum.attribute("custom-discussions-item.enable_likes_count"),s=!1!==e().forum.attribute("custom-discussions-item.enable_reply_avatars");return t||s?m("div",{className:"DiscussionListItem-enhanced"},m("div",{className:"DiscussionListItem-likes"},this.likesInfoView()),m("div",{className:"DiscussionListItem-reply-avatars"},this.replyAvatarsView())):null},o().prototype.likesInfoView=function(){var t=this.attrs.discussion;if(!1===e().forum.attribute("custom-discussions-item.enable_likes_count"))return null;var s=t.data.attributes.likesCount||0;return m("span",{className:"likes-count"},c()("fas fa-heart"),m("span",{className:"count"},e().translator.trans("custom-discussions-item.forum.likes_count",{count:p()(s)})))},o().prototype.replyAvatarsView=function(){var t=this.attrs.discussion,s=!1!==e().forum.attribute("custom-discussions-item.enable_reply_avatars"),a=parseInt(e().forum.attribute("custom-discussions-item.max_reply_avatars"))||5,r=parseInt(e().forum.attribute("custom-discussions-item.avatar_size"))||20;if(console.log("回帖头像配置读取:",{enableReplyAvatars:s,maxAvatars:a,avatarSize:r}),!s)return null;var o=t.data.attributes.replyUsers||[];if(0===o.length)return null;console.log("显示回帖用户头像，数量:",o.length);var n=o.slice(0,a);return m("[",null,m("span",{className:"reply-avatars-label"},e().translator.trans("custom-discussions-item.forum.recent_replies"),":"),m("div",{className:"avatars-list"},n.map(function(t,s){var e={id:function(){return t.id},displayName:function(){return t.displayName},username:function(){return t.username},avatarUrl:function(){return t.avatarUrl}};return m("span",{key:s,className:"reply-avatar",title:t.displayName},i()(e,{size:r}))}),o.length>a&&m("span",{className:"more-avatars",title:e().translator.trans("custom-discussions-item.forum.more_replies",{count:o.length-a})},e().translator.trans("custom-discussions-item.forum.more_replies",{count:o.length-a}))))}})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map